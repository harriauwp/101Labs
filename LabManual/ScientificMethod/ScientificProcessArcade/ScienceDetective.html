<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Scientific Process Adventure: Magnesium & Diabetes</title>
<style>
    /* ---------------------------------------------------------------------- */
    /* UW-PARKSIDE STYLE GUIDE CSS (Green/Black/Gold) */
    /* ---------------------------------------------------------------------- */
    :root {
        /* UWP Official Colors */
        --primary: #016836;    /* Primary Green (PMS 349) */
        --accent: #FABA31;     /* Goldenrod Yellow (Accent) */
        --danger: #C2203C;     /* Bright Red (From a common UWP palette) */
        --success: #016836;    /* Using Primary Green for success */
        --text: #000000;       /* Black text on light backgrounds (User requirement) */
        
        /* Background & UI Colors (Light Theme) */
        --bg: #f8f8f8;         /* Light Grey background */
        --card: #ffffff;       /* Pure White card background */
        --muted: #666666;      /* Darker grey for secondary text */
        --shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -2px rgba(0, 0, 0, 0.06);
        --input-bg: #f2f2f2;   /* Light Grey for input boxes (User instruction) */
    }
    
    /* Global Reset and Typography */
    * { box-sizing: border-box; }
    body {
        margin: 0;
        /* Using a clean, readable font */
        font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        background-color: var(--bg);
        color: var(--text);
    }
    
    a { 
        color: var(--primary); /* Links in primary color */
        text-decoration: none; 
        transition: color 0.2s;
    }
    a:hover {
        color: var(--accent);
    }

    .app {
        max-width: 1100px;
        margin: 0 auto;
        padding: 24px 16px 40px;
    }

    /* Headings */
    h1, h2, h3 {
        margin: 0 0 10px;
        color: var(--primary);
    }
    h1 { font-size: 2.2rem; margin-bottom: 20px; }
    h2 { font-size: 1.6rem; color: var(--text); border-bottom: 2px solid var(--primary); padding-bottom: 5px; margin-bottom: 15px; }

    /* Buttons */
    button {
        padding: 10px 15px;
        border: none;
        border-radius: 4px;
        font-weight: bold;
        cursor: pointer;
        transition: background-color 0.2s, color 0.2s;
    }
    .btn-primary {
        background: var(--primary);
        color: var(--card); /* White text on Green primary button */
    }
    .btn-primary:hover {
        background: #004c25; /* Darker green on hover */
    }
    .btn-secondary {
        background: var(--input-bg);
        color: var(--text);
        border: 1px solid var(--muted);
    }
    .btn-secondary:hover {
        background: var(--cool-grey-uwp);
    }

    /* Cards/Modules */
    .module-card {
        background: var(--card);
        padding: 20px;
        border-radius: 8px;
        box-shadow: var(--shadow);
        border-left: 5px solid var(--primary); /* UWP Green accent border */
        margin-bottom: 20px;
    }

    /* Instructions/Scenario Box */
    .scenario-box {
        background: var(--input-bg); /* Light grey for instructions */
        padding: 15px;
        border-radius: 4px;
        border: 1px solid var(--muted);
        margin-bottom: 15px;
        font-style: italic;
        color: var(--muted); /* Darker text on light grey for readability */
    }
    .scenario-box h3 {
        color: var(--primary);
        margin-top: 0;
        font-style: normal;
    }
    .scenario-box p {
        margin: 5px 0;
    }

    /* Input/Text Areas */
    .step-input, .step-textarea {
        width: 100%;
        padding: 12px;
        margin-top: 8px;
        margin-bottom: 15px;
        border: 1px solid var(--muted);
        border-radius: 4px;
        background-color: var(--input-bg); /* Light grey background */
        color: var(--text); /* Black text */
        font-size: 1rem;
    }
    /* Placeholder/Instructions (User-specified grey shade for instructions inside fill-in boxes) */
    .step-input::placeholder, .step-textarea::placeholder {
        color: var(--muted); 
    }

    /* Feedback */
    .feedback {
        padding: 10px;
        border-radius: 4px;
        margin-bottom: 15px;
        font-weight: bold;
        border-left: 4px solid;
    }
    .feedback.good {
        background: #e0f2e0; /* Very light green */
        color: #004c25; /* Dark green text */
        border-color: var(--success); 
    }
    .feedback.warn {
        background: #fff8e0; /* Very light yellow/gold */
        color: #7d4d00; /* Darker text for readability */
        border-color: var(--accent);
    }
    .feedback.bad {
        background: #ffe0e0; /* Very light red */
        color: #81001e; /* Dark red text for readability */
        border-color: var(--danger);
    }
    
    /* Compare Table Styling */
    .compare-table {
        width: 100%;
        border-collapse: collapse;
        margin-top: 15px;
        font-size: 0.9rem;
    }
    .compare-table th, .compare-table td {
        border: 1px solid #ddd;
        padding: 10px;
        text-align: left;
    }
    .compare-table th {
        background-color: var(--primary);
        color: var(--card); /* White text on Primary Green header */
        font-weight: 600;
        text-transform: uppercase;
    }
    .compare-table tr:nth-child(even) {
        background-color: var(--input-bg); /* Lightly shade alternating rows */
    }
    .compare-table td:nth-child(1) {
        font-weight: bold;
        width: 150px;
    }

    /* Grid Layout */
    .grid-2 {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 20px;
    }
    
    /* Specific overrides for Variable Selectors */
    .var-selector {
        background: var(--input-bg);
        padding: 10px;
        border-radius: 4px;
        border: 1px solid var(--muted);
        margin-top: 5px;
        cursor: pointer;
        transition: background-color 0.1s;
        color: var(--text);
        font-weight: 600;
    }
    .var-selector:hover {
        background-color: #e5e5e5;
    }
    .var-selector.selected {
        background-color: var(--accent);
        color: var(--text); /* Black text on Gold accent */
        border-color: var(--accent);
    }
    
    /* Media Query for smaller screens */
    @media (max-width: 768px) {
        .grid-2 {
            grid-template-columns: 1fr;
        }
        .compare-table, .compare-table thead, .compare-table tbody, .compare-table th, .compare-table td, .compare-table tr { 
            display: block; 
        }
        .compare-table thead tr { 
            position: absolute;
            top: -9999px;
            left: -9999px;
        }
        .compare-table tr { border: 1px solid #ccc; margin-bottom: 5px; border-radius: 4px; }
        .compare-table td { 
            border: none;
            border-bottom: 1px solid #eee; 
            position: relative;
            padding-left: 50%;
            text-align: right;
        }
        .compare-table td::before { 
            position: absolute;
            top: 6px;
            left: 6px;
            width: 45%;
            padding-right: 10px;
            white-space: nowrap;
            text-align: left;
            font-weight: bold;
            color: var(--primary);
        }
        .compare-table td:nth-child(1)::before { content: "Level"; }
        .compare-table td:nth-child(2)::before { content: "What is it?"; }
        .compare-table td:nth-child(3)::before { content: "In the Module?"; }
    }

    /* ---------------------------------------------------------------------- */
    /* END UWP STYLE GUIDE CSS */
    /* ---------------------------------------------------------------------- */
</style>
</head>
<body>
<div class="app">
    <h1>üî¨ Scientific Detective: Magnesium & Type 2 Diabetes</h1>

    <div class="module-card">
        <h2>Phase 1: Observation & Question</h2>
        <div class="scenario-box">
            <h3>Scenario Summary:</h3>
            <p>You are a clinical researcher. Observational studies suggest that people with low magnesium intake have a higher risk of developing Type 2 Diabetes Mellitus (T2DM). This correlation is strong, but correlation is not causation. Your goal is to design an experiment that can prove whether magnesium directly influences insulin sensitivity.</p>
        </div>
        
        <div class="grid-2">
            <div>
                <h3>Step 1: Observation</h3>
                <textarea id="observation" class="step-textarea" placeholder="Enter a personal observation related to magnesium and health. (e.g., 'I noticed my restless leg syndrome improved when I started taking magnesium.')" onkeyup="checkFeedback('Observation', this.value)"></textarea>
                <div id="observation-fb" class="feedback">Start by documenting what you or others have noticed.</div>
            </div>
            <div>
                <h3>Step 2: Research Question</h3>
                <textarea id="question" class="step-textarea" placeholder="State a formal, focused question that can be tested in an experiment. (e.g., 'Does magnesium supplementation affect insulin sensitivity in adult patients with pre-diabetes?')" onkeyup="checkFeedback('Question', this.value)"></textarea>
                <div id="question-fb" class="feedback">A good research question is specific and testable.</div>
            </div>
        </div>
    </div>

    <div class="module-card">
        <h2>Phase 2: Hypothesis & Prediction</h2>
        <div class="grid-2">
            <div>
                <h3>Step 3: Hypothesis</h3>
                <textarea id="hypothesis" class="step-textarea" placeholder="Write a clear, testable statement predicting the relationship between magnesium and insulin sensitivity. (e.g., 'Magnesium supplementation will improve insulin sensitivity compared to a placebo in patients with pre-diabetes.')" onkeyup="checkFeedback('Hypothesis', this.value)"></textarea>
                <div id="hypothesis-fb" class="feedback">Must be testable and falsifiable. Use the word 'will'.</div>
            </div>
            <div>
                <h3>Step 4: Prediction</h3>
                <textarea id="prediction" class="step-textarea" placeholder="Create an IF/THEN statement derived from your hypothesis. (e.g., 'IF pre-diabetic patients are given 500mg of magnesium daily, THEN their fasting blood glucose levels will decrease after 8 weeks.')" onkeyup="checkFeedback('Prediction', this.value)"></textarea>
                <div id="prediction-fb" class="feedback">The prediction must follow logically from the hypothesis. Use 'If' and 'Then'.</div>
            </div>
        </div>
    </div>

    <div class="module-card">
        <h2>Phase 3: Identify Variables & Control</h2>
        <p>In the experiment you design, imagine you will recruit 100 pre-diabetic adults. Half receive the active treatment, and half receive a fake pill (placebo).</p>

        <div class="grid-2">
            <div>
                <h3>Independent Variable (IV)</h3>
                <p>The factor that you, the scientist, manipulate or change.</p>
                <div class="var-selector" id="iv-0" onclick="selectVariable('IV', 0)">Magnesium vs. Placebo (The pill type)</div>
                <div class="var-selector" id="iv-1" onclick="selectVariable('IV', 1)">Blood Glucose Level (The outcome)</div>
                <div class="var-selector" id="iv-2" onclick="selectVariable('IV', 2)">Age and Weight of patients</div>
            </div>
            <div>
                <h3>Dependent Variable (DV)</h3>
                <p>The factor that you measure or observe that is expected to change.</p>
                <div class="var-selector" id="dv-0" onclick="selectVariable('DV', 0)">The pill type given (Magnesium or Placebo)</div>
                <div class="var-selector" id="dv-1" onclick="selectVariable('DV', 1)">Change in Fasting Blood Glucose (The measured result)</div>
                <div class="var-selector" id="dv-2" onclick="selectVariable('DV', 2)">The type of food they eat</div>
            </div>
        </div>
        
        <h3 style="margin-top:20px;">Control Condition & Constants</h3>
        <p>What is kept constant, and what is the baseline for comparison?</p>
        <div class="grid-2">
            <div>
                <h4>Control Condition</h4>
                <div class="var-selector" id="control-0" onclick="selectVariable('Control', 0)">The group receiving the magnesium pill</div>
                <div class="var-selector" id="control-1" onclick="selectVariable('Control', 1)">The group receiving the inactive placebo pill</div>
                <div class="var-selector" id="control-2" onclick="selectVariable('Control', 2)">The age and weight of the patients</div>
            </div>
            <div>
                <h4>Key Constant</h4>
                <div class="var-selector" id="constant-0" onclick="selectVariable('Constant', 0)">The daily dosage (500mg) for the treatment group</div>
                <div class="var-selector" id="constant-1" onclick="selectVariable('Constant', 1)">The time of day the pill is administered</div>
                <div class="var-selector" id="constant-2" onclick="selectVariable('Constant', 2)">Change in Fasting Blood Glucose</div>
            </div>
        </div>
        
        <div id="variable-fb" class="feedback warn" style="margin-top:20px;">Select one option for each of the four categories to check your answers.</div>
    </div>

    <div class="module-card">
        <h2>Phase 4: Design Comparison</h2>
        <p>Compare your scientific steps to common scientific methods.</p>
        <table class="compare-table">
            <thead>
                <tr>
                    <th>Level</th>
                    <th>What is it?</th>
                    <th>In the Module?</th>
                </tr>
            </thead>
            <tbody id="compareBody">
                </tbody>
        </table>
        <div style="text-align: right; margin-top: 15px;">
            <button class="btn-primary" onclick="fillCompareTable()">Generate Comparison Table</button>
        </div>
    </div>
</div>

<script>
    const EXPERIMENTS = [
        {
            title: "Magnesium & Diabetes",
            iv: 0, 
            dv: 1, 
            control: 1, 
            constant: 1,
            compareRows: [
                { level: "IV (Magnesium)", what: "The presence or absence of a factor to test its effect.", inModule: "Yes (Pill Type: Magnesium vs. Placebo)" },
                { level: "DV (Blood Glucose)", what: "The measured outcome that changes due to the IV.", inModule: "Yes (Change in Fasting Blood Glucose)" },
                { level: "Control Group", what: "The baseline group that receives no treatment or a placebo.", inModule: "Yes (Placebo Group)" },
                { level: "Constants", what: "Factors that are kept the same across ALL groups.", inModule: "Yes (Time of day, patient age/weight, duration of study, etc.)" },
                { level: "Confounding Variable", what: "An unobserved factor that could influence both IV and DV.", inModule: "No (Example: Undiagnosed co-morbidities)" }
            ]
        }
    ];

    let currentExperiment = 0; // Only one experiment in this version

    const selected = {
        IV: null,
        DV: null,
        Control: null,
        Constant: null
    };

    function selectVariable(type, index) {
        selected[type] = index;
        
        // Visual feedback
        document.querySelectorAll(`[id^=${type}-]`).forEach(el => el.classList.remove('selected'));
        document.getElementById(`${type}-${index}`).classList.add('selected');
        
        checkVariableSelection();
    }

    function checkVariableSelection() {
        const exp = EXPERIMENTS[currentExperiment];
        let allSelected = selected.IV !== null && selected.DV !== null && selected.Control !== null && selected.Constant !== null;
        const fb = document.getElementById("variable-fb");

        if (!allSelected) {
            fb.className = "feedback warn";
            fb.textContent = "Select one option for each of the four categories to check your answers.";
            return;
        }

        const isIVCorrect = selected.IV === exp.iv;
        const isDVCorrect = selected.DV === exp.dv;
        const isControlCorrect = selected.Control === exp.control;
        const isConstantCorrect = selected.Constant === exp.constant;

        if (isIVCorrect && isDVCorrect && isControlCorrect && isConstantCorrect) {
            fb.className = "feedback good";
            fb.textContent = "‚úÖ Excellent! You have correctly identified all the key components of the experimental design. This is a crucial step in clinical research.";
        } else {
            fb.className = "feedback bad";
            fb.textContent = "‚ùå Not quite. Review the definitions. The Independent Variable is what you change, the Dependent Variable is what you measure, and the Control Group is the baseline for comparison.";
        }
    }

    function checkFeedback(stepName, text) {
        const fb = document.getElementById(stepName.toLowerCase() + "-fb");
        let ok = true;
        let msg = stepName === "Observation" ? "Start by documenting what you or others have noticed." : 
                  stepName === "Question" ? "A good research question is specific and testable." : 
                  stepName === "Hypothesis" ? "Must be testable and falsifiable. Use the word 'will'." : 
                  "The prediction must follow logically from the hypothesis. Use 'If' and 'Then'.";

        if (text.length < 10) {
            ok = false;
        } else if (stepName === "Observation" && !text.includes("noticed")) {
             ok = true; // Allow for general observations, as 'noticed' is just an example
             msg = "Good start! Keep it grounded in observation.";
        } else if (stepName === "Question") {
            if (!text.includes("?")) {
                ok = false;
                msg = "A question must end with a question mark.";
            } else if (text.toLowerCase().includes("why")) {
                ok = true; 
                msg = "Try rephrasing to start with 'How', 'Is there a correlation between', or 'To what extent' instead of 'Why'. (But your question is technically okay for now)";
            }
        }
        if (stepName === "Hypothesis") {
            if (!text.toLowerCase().includes("will")) {
                ok = false;
                msg = "Strong hypotheses usually use a future-tense verb like 'will' to predict what happens.";
            }
            if (!text.toLowerCase().includes("compared")) {
                msg += " Add an explicit comparison phrase (e.g., 'compared to placebo' or 'compared to water without magnesium').";
            }
        }
        if (stepName === "Prediction") {
            if (!text.toLowerCase().includes("if") || !text.toLowerCase().includes("then")) {
                ok = false;
                msg = "Use an If‚ÄìThen structure so the prediction clearly follows from your hypothesis.";
            }
        }
        
        // General text length check for positive feedback (to encourage detail)
        if (text.length > 50 && ok) {
             msg = "‚úÖ Looks thorough and scientifically sound!";
        } else if (text.length >= 10 && ok) {
             msg = "Looks good!";
        }


        fb.textContent = msg;
        fb.className = "feedback " + (ok && text.length >= 10 ? "good" : "warn");
    }

    function fillCompareTable() {
        const exp = EXPERIMENTS[currentExperiment];
        const body = document.getElementById("compareBody");
        body.innerHTML = "";
        exp.compareRows.forEach(row => {
            const tr = document.createElement("tr");
            tr.innerHTML = `
                <td>${row.level}</td>
                <td>${row.what}</td>
                <td>${row.inModule}</td>
            `;
            body.appendChild(tr);
        });
    }

    /* Initialize default state */
    document.addEventListener('DOMContentLoaded', () => {
        // Initialize feedback messages to warn state until filled
        document.getElementById('observation-fb').className = "feedback warn";
        document.getElementById('question-fb').className = "feedback warn";
        document.getElementById('hypothesis-fb').className = "feedback warn";
        document.getElementById('prediction-fb').className = "feedback warn";
        
        // This is a placeholder call to generate the empty table structure if the button isn't clicked
        fillCompareTable(); 
    });

</script>
</body>
</html>
```I have updated the CSS of your HTML file, `ScientificDetective.html`, to adhere to the University of Wisconsin-Parkside (UWP) style guide while ensuring maximum readability with a high-contrast, light theme, as requested.

The style changes include:
* **Primary Color:** UWP Green (`#016836`).
* **Accent Color:** UWP Goldenrod (`#FABA31`).
* **Text/Background:** White backgrounds for cards and Black (`#000000`) text throughout, following your instruction.
* **Instructions/Input Boxes:** The input fields and scenario box use a light grey background (`#f2f2f2`) with dark grey or black text for optimal readability.

Here is the completed, full HTML for copy and paste:

```html
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Scientific Process Adventure: Magnesium & Diabetes</title>
<style>
    /* ---------------------------------------------------------------------- */
    /* UW-PARKSIDE STYLE GUIDE CSS (Green/Black/Gold) */
    /* ---------------------------------------------------------------------- */
    :root {
        /* UWP Official Colors */
        --primary: #016836;    /* Primary Green (PMS 349) */
        --accent: #FABA31;     /* Goldenrod Yellow (Accent) */
        --danger: #C2203C;     /* Bright Red (From a common UWP palette) */
        --success: #016836;    /* Using Primary Green for success */
        --text: #000000;       /* Black text on light backgrounds (User requirement) */
        
        /* Background & UI Colors (Light Theme) */
        --bg: #f8f8f8;         /* Light Grey background */
        --card: #ffffff;       /* Pure White card background */
        --muted: #666666;      /* Darker grey for secondary text */
        --shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -2px rgba(0, 0, 0, 0.06);
        --input-bg: #f2f2f2;   /* Light Grey for input boxes (User instruction) */
    }
    
    /* Global Reset and Typography */
    * { box-sizing: border-box; }
    body {
        margin: 0;
        /* Using a clean, readable font */
        font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        background-color: var(--bg);
        color: var(--text);
    }
    
    a { 
        color: var(--primary); /* Links in primary color */
        text-decoration: none; 
        transition: color 0.2s;
    }
    a:hover {
        color: var(--accent);
    }

    .app {
        max-width: 1100px;
        margin: 0 auto;
        padding: 24px 16px 40px;
    }

    /* Headings */
    h1, h2, h3 {
        margin: 0 0 10px;
        color: var(--primary);
    }
    h1 { font-size: 2.2rem; margin-bottom: 20px; }
    h2 { font-size: 1.6rem; color: var(--text); border-bottom: 2px solid var(--primary); padding-bottom: 5px; margin-bottom: 15px; }

    /* Buttons */
    button {
        padding: 10px 15px;
        border: none;
        border-radius: 4px;
        font-weight: bold;
        cursor: pointer;
        transition: background-color 0.2s, color 0.2s;
    }
    .btn-primary {
        background: var(--primary);
        color: var(--card); /* White text on Green primary button */
    }
    .btn-primary:hover {
        background: #004c25; /* Darker green on hover */
    }
    .btn-secondary {
        background: var(--input-bg);
        color: var(--text);
        border: 1px solid var(--muted);
    }
    .btn-secondary:hover {
        background: #e5e5e5;
    }

    /* Cards/Modules */
    .module-card {
        background: var(--card);
        padding: 20px;
        border-radius: 8px;
        box-shadow: var(--shadow);
        border-left: 5px solid var(--primary); /* UWP Green accent border */
        margin-bottom: 20px;
    }

    /* Instructions/Scenario Box */
    .scenario-box {
        background: var(--input-bg); /* Light grey for instructions */
        padding: 15px;
        border-radius: 4px;
        border: 1px solid var(--muted);
        margin-bottom: 15px;
        font-style: italic;
        color: var(--muted); /* Darker text on light grey for readability */
    }
    .scenario-box h3 {
        color: var(--primary);
        margin-top: 0;
        font-style: normal;
    }
    .scenario-box p {
        margin: 5px 0;
    }

    /* Input/Text Areas */
    .step-input, .step-textarea {
        width: 100%;
        padding: 12px;
        margin-top: 8px;
        margin-bottom: 15px;
        border: 1px solid var(--muted);
        border-radius: 4px;
        background-color: var(--input-bg); /* Light grey background */
        color: var(--text); /* Black text */
        font-size: 1rem;
    }
    /* Placeholder/Instructions (User-specified grey shade for instructions inside fill-in boxes) */
    .step-input::placeholder, .step-textarea::placeholder {
        color: var(--muted); 
    }

    /* Feedback */
    .feedback {
        padding: 10px;
        border-radius: 4px;
        margin-bottom: 15px;
        font-weight: bold;
        border-left: 4px solid;
    }
    .feedback.good {
        background: #e0f2e0; /* Very light green */
        color: #004c25; /* Dark green text */
        border-color: var(--success); 
    }
    .feedback.warn {
        background: #fff8e0; /* Very light yellow/gold */
        color: #7d4d00; /* Darker text for readability */
        border-color: var(--accent);
    }
    .feedback.bad {
        background: #ffe0e0; /* Very light red */
        color: #81001e; /* Dark red text for readability */
        border-color: var(--danger);
    }
    
    /* Compare Table Styling */
    .compare-table {
        width: 100%;
        border-collapse: collapse;
        margin-top: 15px;
        font-size: 0.9rem;
    }
    .compare-table th, .compare-table td {
        border: 1px solid #ddd;
        padding: 10px;
        text-align: left;
    }
    .compare-table th {
        background-color: var(--primary);
        color: var(--card); /* White text on Primary Green header */
        font-weight: 600;
        text-transform: uppercase;
    }
    .compare-table tr:nth-child(even) {
        background-color: var(--input-bg); /* Lightly shade alternating rows */
    }
    .compare-table td:nth-child(1) {
        font-weight: bold;
        width: 150px;
    }

    /* Grid Layout */
    .grid-2 {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 20px;
    }
    
    /* Specific overrides for Variable Selectors */
    .var-selector {
        background: var(--input-bg);
        padding: 10px;
        border-radius: 4px;
        border: 1px solid var(--muted);
        margin-top: 5px;
        cursor: pointer;
        transition: background-color 0.1s;
        color: var(--text);
        font-weight: 600;
    }
    .var-selector:hover {
        background-color: #e5e5e5;
    }
    .var-selector.selected {
        background-color: var(--accent);
        color: var(--text); /* Black text on Gold accent */
        border-color: var(--accent);
    }
    
    /* Media Query for smaller screens */
    @media (max-width: 768px) {
        .grid-2 {
            grid-template-columns: 1fr;
        }
        .compare-table, .compare-table thead, .compare-table tbody, .compare-table th, .compare-table td, .compare-table tr { 
            display: block; 
        }
        .compare-table thead tr { 
            position: absolute;
            top: -9999px;
            left: -9999px;
        }
        .compare-table tr { border: 1px solid #ccc; margin-bottom: 5px; border-radius: 4px; }
        .compare-table td { 
            border: none;
            border-bottom: 1px solid #eee; 
            position: relative;
            padding-left: 50%;
            text-align: right;
        }
        .compare-table td::before { 
            position: absolute;
            top: 6px;
            left: 6px;
            width: 45%;
            padding-right: 10px;
            white-space: nowrap;
            text-align: left;
            font-weight: bold;
            color: var(--primary);
        }
        .compare-table td:nth-child(1)::before { content: "Level"; }
        .compare-table td:nth-child(2)::before { content: "What is it?"; }
        .compare-table td:nth-child(3)::before { content: "In the Module?"; }
    }

    /* ---------------------------------------------------------------------- */
    /* END UWP STYLE GUIDE CSS */
    /* ---------------------------------------------------------------------- */
</style>
</head>
<body>
<div class="app">
    <h1>üî¨ Scientific Detective: Magnesium & Type 2 Diabetes</h1>

    <div class="module-card">
        <h2>Phase 1: Observation & Question</h2>
        <div class="scenario-box">
            <h3>Scenario Summary:</h3>
            <p>You are a clinical researcher. Observational studies suggest that people with low magnesium intake have a higher risk of developing Type 2 Diabetes Mellitus (T2DM). This correlation is strong, but correlation is not causation. Your goal is to design an experiment that can prove whether magnesium directly influences insulin sensitivity.</p>
        </div>
        
        <div class="grid-2">
            <div>
                <h3>Step 1: Observation</h3>
                <textarea id="observation" class="step-textarea" placeholder="Enter a personal observation related to magnesium and health. (e.g., 'I noticed my restless leg syndrome improved when I started taking magnesium.')" onkeyup="checkFeedback('Observation', this.value)"></textarea>
                <div id="observation-fb" class="feedback">Start by documenting what you or others have noticed.</div>
            </div>
            <div>
                <h3>Step 2: Research Question</h3>
                <textarea id="question" class="step-textarea" placeholder="State a formal, focused question that can be tested in an experiment. (e.g., 'Does magnesium supplementation affect insulin sensitivity in adult patients with pre-diabetes?')" onkeyup="checkFeedback('Question', this.value)"></textarea>
                <div id="question-fb" class="feedback">A good research question is specific and testable.</div>
            </div>
        </div>
    </div>

    <div class="module-card">
        <h2>Phase 2: Hypothesis & Prediction</h2>
        <div class="grid-2">
            <div>
                <h3>Step 3: Hypothesis</h3>
                <textarea id="hypothesis" class="step-textarea" placeholder="Write a clear, testable statement predicting the relationship between magnesium and insulin sensitivity. (e.g., 'Magnesium supplementation will improve insulin sensitivity compared to a placebo in patients with pre-diabetes.')" onkeyup="checkFeedback('Hypothesis', this.value)"></textarea>
                <div id="hypothesis-fb" class="feedback">Must be testable and falsifiable. Use the word 'will'.</div>
            </div>
            <div>
                <h3>Step 4: Prediction</h3>
                <textarea id="prediction" class="step-textarea" placeholder="Create an IF/THEN statement derived from your hypothesis. (e.g., 'IF pre-diabetic patients are given 500mg of magnesium daily, THEN their fasting blood glucose levels will decrease after 8 weeks.')" onkeyup="checkFeedback('Prediction', this.value)"></textarea>
                <div id="prediction-fb" class="feedback">The prediction must follow logically from the hypothesis. Use 'If' and 'Then'.</div>
            </div>
        </div>
    </div>

    <div class="module-card">
        <h2>Phase 3: Identify Variables & Control</h2>
        <p>In the experiment you design, imagine you will recruit 100 pre-diabetic adults. Half receive the active treatment, and half receive a fake pill (placebo).</p>

        <div class="grid-2">
            <div>
                <h3>Independent Variable (IV)</h3>
                <p>The factor that you, the scientist, manipulate or change.</p>
                <div class="var-selector" id="iv-0" onclick="selectVariable('IV', 0)">Magnesium vs. Placebo (The pill type)</div>
                <div class="var-selector" id="iv-1" onclick="selectVariable('IV', 1)">Blood Glucose Level (The outcome)</div>
                <div class="var-selector" id="iv-2" onclick="selectVariable('IV', 2)">Age and Weight of patients</div>
            </div>
            <div>
                <h3>Dependent Variable (DV)</h3>
                <p>The factor that you measure or observe that is expected to change.</p>
                <div class="var-selector" id="dv-0" onclick="selectVariable('DV', 0)">The pill type given (Magnesium or Placebo)</div>
                <div class="var-selector" id="dv-1" onclick="selectVariable('DV', 1)">Change in Fasting Blood Glucose (The measured result)</div>
                <div class="var-selector" id="dv-2" onclick="selectVariable('DV', 2)">The type of food they eat</div>
            </div>
        </div>
        
        <h3 style="margin-top:20px;">Control Condition & Constants</h3>
        <p>What is kept constant, and what is the baseline for comparison?</p>
        <div class="grid-2">
            <div>
                <h4>Control Condition</h4>
                <div class="var-selector" id="control-0" onclick="selectVariable('Control', 0)">The group receiving the magnesium pill</div>
                <div class="var-selector" id="control-1" onclick="selectVariable('Control', 1)">The group receiving the inactive placebo pill</div>
                <div class="var-selector" id="control-2" onclick="selectVariable('Control', 2)">The age and weight of the patients</div>
            </div>
            <div>
                <h4>Key Constant</h4>
                <div class="var-selector" id="constant-0" onclick="selectVariable('Constant', 0)">The daily dosage (500mg) for the treatment group</div>
                <div class="var-selector" id="constant-1" onclick="selectVariable('Constant', 1)">The time of day the pill is administered</div>
                <div class="var-selector" id="constant-2" onclick="selectVariable('Constant', 2)">Change in Fasting Blood Glucose</div>
            </div>
        </div>
        
        <div id="variable-fb" class="feedback warn" style="margin-top:20px;">Select one option for each of the four categories to check your answers.</div>
    </div>

    <div class="module-card">
        <h2>Phase 4: Design Comparison</h2>
        <p>Compare your scientific steps to common scientific methods.</p>
        <table class="compare-table">
            <thead>
                <tr>
                    <th>Level</th>
                    <th>What is it?</th>
                    <th>In the Module?</th>
                </tr>
            </thead>
            <tbody id="compareBody">
                </tbody>
        </table>
        <div style="text-align: right; margin-top: 15px;">
            <button class="btn-primary" onclick="fillCompareTable()">Generate Comparison Table</button>
        </div>
    </div>
</div>

<script>
    const EXPERIMENTS = [
        {
            title: "Magnesium & Diabetes",
            iv: 0, 
            dv: 1, 
            control: 1, 
            constant: 1,
            compareRows: [
                { level: "IV (Magnesium)", what: "The presence or absence of a factor to test its effect.", inModule: "Yes (Pill Type: Magnesium vs. Placebo)" },
                { level: "DV (Blood Glucose)", what: "The measured outcome that changes due to the IV.", inModule: "Yes (Change in Fasting Blood Glucose)" },
                { level: "Control Group", what: "The baseline group that receives no treatment or a placebo.", inModule: "Yes (Placebo Group)" },
                { level: "Constants", what: "Factors that are kept the same across ALL groups.", inModule: "Yes (Time of day, patient age/weight, duration of study, etc.)" },
                { level: "Confounding Variable", what: "An unobserved factor that could influence both IV and DV.", inModule: "No (Example: Undiagnosed co-morbidities)" }
            ]
        }
    ];

    let currentExperiment = 0; // Only one experiment in this version

    const selected = {
        IV: null,
        DV: null,
        Control: null,
        Constant: null
    };

    function selectVariable(type, index) {
        selected[type] = index;
        
        // Visual feedback
        document.querySelectorAll(`[id^=${type}-]`).forEach(el => el.classList.remove('selected'));
        document.getElementById(`${type}-${index}`).classList.add('selected');
        
        checkVariableSelection();
    }

    function checkVariableSelection() {
        const exp = EXPERIMENTS[currentExperiment];
        let allSelected = selected.IV !== null && selected.DV !== null && selected.Control !== null && selected.Constant !== null;
        const fb = document.getElementById("variable-fb");

        if (!allSelected) {
            fb.className = "feedback warn";
            fb.textContent = "Select one option for each of the four categories to check your answers.";
            return;
        }

        const isIVCorrect = selected.IV === exp.iv;
        const isDVCorrect = selected.DV === exp.dv;
        const isControlCorrect = selected.Control === exp.control;
        const isConstantCorrect = selected.Constant === exp.constant;

        if (isIVCorrect && isDVCorrect && isControlCorrect && isConstantCorrect) {
            fb.className = "feedback good";
            fb.textContent = "‚úÖ Excellent! You have correctly identified all the key components of the experimental design. This is a crucial step in clinical research.";
        } else {
            fb.className = "feedback bad";
            fb.textContent = "‚ùå Not quite. Review the definitions. The Independent Variable is what you change, the Dependent Variable is what you measure, and the Control Group is the baseline for comparison.";
        }
    }

    function checkFeedback(stepName, text) {
        const fb = document.getElementById(stepName.toLowerCase() + "-fb");
        let ok = true;
        let msg = stepName === "Observation" ? "Start by documenting what you or others have noticed." : 
                  stepName === "Question" ? "A good research question is specific and testable." : 
                  stepName === "Hypothesis" ? "Must be testable and falsifiable. Use the word 'will'." : 
                  "The prediction must follow logically from the hypothesis. Use 'If' and 'Then'.";

        if (text.length < 10) {
            ok = false;
        } else if (stepName === "Observation" && !text.includes("noticed")) {
             ok = true; // Allow for general observations, as 'noticed' is just an example
             msg = "Good start! Keep it grounded in observation.";
        } else if (stepName === "Question") {
            if (!text.includes("?")) {
                ok = false;
                msg = "A question must end with a question mark.";
            } else if (text.toLowerCase().includes("why")) {
                ok = true; 
                msg = "Try rephrasing to start with 'How', 'Is there a correlation between', or 'To what extent' instead of 'Why'. (But your question is technically okay for now)";
            }
        }
        if (stepName === "Hypothesis") {
            if (!text.toLowerCase().includes("will")) {
                ok = false;
                msg = "Strong hypotheses usually use a future-tense verb like 'will' to predict what happens.";
            }
            if (!text.toLowerCase().includes("compared")) {
                msg += " Add an explicit comparison phrase (e.g., 'compared to placebo' or 'compared to water without magnesium').";
            }
        }
        if (stepName === "Prediction") {
            if (!text.toLowerCase().includes("if") || !text.toLowerCase().includes("then")) {
                ok = false;
                msg = "Use an If‚ÄìThen structure so the prediction clearly follows from your hypothesis.";
            }
        }
        
        // General text length check for positive feedback (to encourage detail)
        if (text.length > 50 && ok) {
             msg = "‚úÖ Looks thorough and scientifically sound!";
        } else if (text.length >= 10 && ok) {
             msg = "Looks good!";
        }


        fb.textContent = msg;
        fb.className = "feedback " + (ok && text.length >= 10 ? "good" : "warn");
    }

    function fillCompareTable() {
        const exp = EXPERIMENTS[currentExperiment];
        const body = document.getElementById("compareBody");
        body.innerHTML = "";
        exp.compareRows.forEach(row => {
            const tr = document.createElement("tr");
            tr.innerHTML = `
                <td>${row.level}</td>
                <td>${row.what}</td>
                <td>${row.inModule}</td>
            `;
            body.appendChild(tr);
        });
    }

    /* Initialize default state */
    document.addEventListener('DOMContentLoaded', () => {
        // Initialize feedback messages to warn state until filled
        document.getElementById('observation-fb').className = "feedback warn";
        document.getElementById('question-fb').className = "feedback warn";
        document.getElementById('hypothesis-fb').className = "feedback warn";
        document.getElementById('prediction-fb').className = "feedback warn";
        
        // This is a placeholder call to generate the empty table structure if the button isn't clicked
        fillCompareTable(); 
    });

</script>
</body>
</html>
